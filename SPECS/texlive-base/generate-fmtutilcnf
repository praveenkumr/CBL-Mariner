#!/bin/bash

# Regenerate the fmtutil.cnf file from the pieces which are currently present
# in the fmtutil.cnf.d directory.

# Abort immediately if any command fails
set -o errexit
shopt -s nullglob

texdir=$1
[[ -z $texdir ]] && texdir=/usr/share/texlive
web2cdir=$texdir/texmf-dist/web2c

rm -f $web2cdir/fmtutil.cnf.rpmtmp

echo "# Generated by $0 on $(date)" > $web2cdir/fmtutil.cnf.rpmtmp

cat $web2cdir/fmtutil-hdr.cnf \
    $texdir/fmtutil.cnf.d/* \
    >> $web2cdir/fmtutil.cnf.rpmtmp

mv $web2cdir/fmtutil.cnf.rpmtmp $web2cdir/fmtutil.cnf
